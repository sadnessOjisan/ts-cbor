import { toCBOR } from "../../helper";
import { StringDecoder } from "../StringDecoder";

describe("StringDecoder", () => {
  describe("decode", () => {
    test("1文字", () => {
      const input = toCBOR("6161");
      const actual = StringDecoder.decode(input);
      expect(actual).toBe("a");
    });
    test("英数混在", () => {
      const input = toCBOR("63613062");
      const actual = StringDecoder.decode(input);
      expect(actual).toBe("a0b");
    });
    test("24文字", () => {
      const input = toCBOR(
        "7818616161616161616161616161616161616161616161616161"
      );
      const actual = StringDecoder.decode(input);
      expect(actual).toBe("a".repeat(24));
    });
    test("マルチバイト文字混在", () => {
      const input = toCBOR(
        "790300E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182E38182"
      );
      const actual = StringDecoder.decode(input);
      expect(actual).toBe("あ".repeat(256));
    });

    test("66E38182 の E38182　は「あ」だけど,66は2文字なのでエラー", () => {
      const input = toCBOR("66E38182");
      expect(() => StringDecoder.decode(input)).toThrowError();
    });
    test("66E38182E38182", () => {
      const input = toCBOR("66E38182E38182");
      const actual = StringDecoder.decode(input);
      expect(actual).toBe("ああ");
    });
  });
});
